var $jscomp={scope:{},owns:function(b,m){return Object.prototype.hasOwnProperty.call(b,m)}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,m,q){if(q.get||q.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[m]=q.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,m,q,r){if(m){q=$jscomp.global;b=b.split(".");for(r=0;r<b.length-1;r++){var t=b[r];t in q||(q[t]={});q=q[t]}b=b[b.length-1];r=q[b];m=m(r);m!=r&&null!=m&&$jscomp.defineProperty(q,b,{configurable:!0,writable:!0,value:m})}};$jscomp.polyfill("Object.assign",function(b){return b?b:function(b,q){for(var m=1;m<arguments.length;m++){var t=arguments[m];if(t)for(var x in t)$jscomp.owns(t,x)&&(b[x]=t[x])}return b}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var m=0;return $jscomp.iteratorPrototype(function(){return m<b.length?{done:!1,value:b[m++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(b,m){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var q=0,r={next:function(){if(q<b.length){var t=q++;return{value:m(t,b[t]),done:!1}}r.next=function(){return{done:!0,value:void 0}};return r.next()}};r[Symbol.iterator]=function(){return r};return r};
$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6-impl","es3");
(function(){function b(a,d,g){a={type:"call_service",domain:a,service:d};return g&&(a.service_data=g),a}function m(a){var d={type:"subscribe_events"};return a&&(d.event_type=a),d}function q(a){return a.result}function r(a,d){return new Promise(function(g,c){var e=null,h=a.subscribeEvents(function(a){var f=a.data;a=f.entity_id;(f=f.new_state)?(a=Object.assign({},e),a=(a[f.entity_id]=f,a)):(f=Object.assign({},e),a=(delete f[a],f));e=a;d(e)},"state_changed"),b=a.getStates().then(function(a){for(var f=
{},c=0;c<a.length;c++){var l=a[c];f[l.entity_id]=l}e=f;d(e)});Promise.all([h,b]).then(function(a){return g(a[0])},function(){return c()})})}function t(a){return a.substr(0,a.indexOf("."))}function x(a,d){var g={};return d.attributes.entity_id.forEach(function(c){(c=a[c])&&(g[c.entity_id]=c)}),g}function N(a){var d=[],g={};return Object.keys(a).forEach(function(c){var e=a[c];"group"===t(c)?d.push(e):g[c]=e}),d.sort(function(a,d){return a.attributes.order-d.attributes.order}),d.forEach(function(a){return a.attributes.entity_id.forEach(function(a){delete g[a]})}),
{groups:d,ungrouped:g}}function O(a,d,g){var c=document.createElement("div");c.className="mdl-list__item";var e=document.createElement("span");e.className="mdl-list__item-primary-content";var h=document.createElement("span"),b=document.createTextNode(a.entity.attributes.friendly_name);h.appendChild(b);e.appendChild(h);c.appendChild(e);var k=document.createTextNode("\n  ");c.appendChild(k);var f=document.createElement("span");f.className="mdl-list__item-secondary-action";var n=document.createComment("#if canSwitch(entity)");
f.appendChild(n);var l=null,p=null;z.helpers.canSwitch(a.entity)?l=A(a,d,f,n):p=B(a,d,f,n);c.appendChild(f);g.appendChild(c);return{update:function(a,c){b.data=c.entity.attributes.friendly_name;z.helpers.canSwitch(c.entity)?(l?l.update(a,c):l=A(c,d,f,n),p&&(p.teardown(!0),p=null)):(l&&(l.teardown(!0),l=null),p?p.update(a,c):p=B(c,d,f,n));p&&p.update(a,c)},teardown:function(a){a&&c.parentNode.removeChild(c);k.parentNode.removeChild(k);l&&l.teardown(a);p&&p.teardown(a)}}}function B(a,d,g,c){var e=document.createTextNode("\n      ");
c.parentNode.insertBefore(e,c);var h=document.createTextNode(a.entity.state);c.parentNode.insertBefore(h,c);var b=document.createTextNode("\n    ");c.parentNode.insertBefore(b,c);return{update:function(a,f){h.data=f.entity.state},teardown:function(a){e.parentNode.removeChild(e);b.parentNode.removeChild(b)}}}function A(a,d,g,c){var e=document.createElement("input");e.setAttribute("data-entity_id",a.entity.entity_id);e.type="checkbox";e.className="mdl-switch__input";e.checked="on"==a.entity.state;c.parentNode.insertBefore(e,
c);return{update:function(a,c){e.setAttribute("data-entity_id",c.entity.entity_id);e.checked="on"==c.entity.state},teardown:function(a){a&&e.parentNode.removeChild(e)}}}function P(a){function d(a,c,l){for(var f in a)if(f in c){var d=c[f],n=l[f];if(d!==n||"object"===typeof d){var e=a[f];if(e)for(var b=0;b<e.length;b+=1){var h=e[b];h.__calling||(h.__calling=!0,h.call(g,d,n),h.__calling=!1)}}}}var g=this,c=a.data||{},e=Object.create(null),b=Object.create(null),v=Object.create(null);this.fire=function(a,
c){if(a=a in v&&v[a].slice())for(var f=0;f<a.length;f+=1)a[f].call(this,c)};this.get=function(a){return c[a]};this.set=function(a){var f=c;c=Object.assign({},f,a);d(e,a,f);k&&k.update(a,c);d(b,a,f)};this.observe=function(a,d,l){l=void 0===l?{}:l;var f=l.defer?b:e;(f[a]||(f[a]=[])).push(d);!1!==l.init&&(d.__calling=!0,d.call(g,c[a]),d.__calling=!1);return{cancel:function(){var c=f[a].indexOf(d);~c&&f[a].splice(c,1)}}};this.on=function(a,c){var f=v[a]||(v[a]=[]);f.push(c);return{cancel:function(){var a=
f.indexOf(c);~a&&f.splice(a,1)}}};this.teardown=function(a){this.fire("teardown");k.teardown(!1!==a);k=null;c={}};var k=O(c,this,a.target)}function C(a,d,b){if("entities"in d&&"object"===typeof a.entities||a.entities!==b.entities||"group"in d&&"object"===typeof a.group||a.group!==b.group)a.entList=d.entList=D.computed.entList(a.entities,a.group)}function Q(){var a=document.createElement("style");a.textContent="       \n .mdl-card[svelte-1786261835], [svelte-1786261835] .mdl-card {\n  margin-right: 16px;\n  margin-bottom: 16px;\n }\n\n .mdl-card__title[svelte-1786261835], [svelte-1786261835] .mdl-card__title {\n  text-transform: capitalize;\n }\n\n .mdl-list[svelte-1786261835], [svelte-1786261835] .mdl-list {\n  padding: 0;\n }\n";
document.head.appendChild(a);E=!0}function R(a,d,b){var c=document.createElement("div");c.setAttribute("svelte-1786261835","");c.className="mdl-card mdl-shadow--2dp";var e=document.createElement("div");e.className="mdl-card__title";var h=document.createElement("h2");h.className="mdl-card__title-text";var g=document.createTextNode(a.group.attributes.friendly_name);h.appendChild(g);e.appendChild(h);c.appendChild(e);var k=document.createTextNode("\n  ");c.appendChild(k);e=document.createElement("div");
e.className="mdl-card__supporting-text";h=document.createElement("div");h.className="mdl-list";var f=document.createComment("#each entList");h.appendChild(f);for(var n=a.entList,l=document.createDocumentFragment(),p=[],w=0;w<n.length;w+=1)p[w]=F(a,n,n[w],w,d,l);f.parentNode.insertBefore(l,f);e.appendChild(h);c.appendChild(e);b.appendChild(c);return{update:function(a,c){g.data=c.group.attributes.friendly_name;for(var e=c.entList,b=0;b<e.length;b+=1)p[b]?p[b].update(a,c,e,e[b],b):p[b]=F(c,e,e[b],b,
d,l);for(b=e.length;b<p.length;b+=1)p[b].teardown(!0);f.parentNode.insertBefore(l,f);p.length=e.length},teardown:function(a){a&&c.parentNode.removeChild(c);k.parentNode.removeChild(k);for(var d=0;d<p.length;d+=1)p[d].teardown(a);a&&f.parentNode.removeChild(f)}}}function F(a,d,b,c,e,h){var g=document.createComment("#if entity.attributes.friendly_name");h.appendChild(g);var k=b.attributes.friendly_name?G(a,d,b,c,e,h,g):null;return{update:function(a,c,d,b,w){b=d[w];b.attributes.friendly_name?k?k.update(a,
c,d,b,w):k=G(c,d,b,w,e,h,g):k&&(k.teardown(!0),k=null)},teardown:function(a){k&&k.teardown(a);a&&g.parentNode.removeChild(g)}}}function G(a,d,b,c,e,h,v){var g=new D.components.EntityRow({target:h,parent:e,data:{entity:b}});return{update:function(a,c,d,b,e){c={};"entList"in a&&(c.entity=b);Object.keys(c).length&&g.set(c)},teardown:function(a){g.teardown(!0)}}}function S(a){function d(a,c,d){for(var f in a)if(f in c){var e=c[f],l=d[f];if(e!==l||"object"===typeof e){var h=a[f];if(h)for(var g=0;g<h.length;g+=
1){var n=h[g];n.__calling||(n.__calling=!0,n.call(b,e,l),n.__calling=!1)}}}}var b=this,c=a.data||{};C(c,c,{});var e=Object.create(null),h=Object.create(null),v=Object.create(null);this.fire=function(a,c){if(a=a in v&&v[a].slice())for(var f=0;f<a.length;f+=1)a[f].call(this,c)};this.get=function(a){return c[a]};this.set=function(a){var f=c;c=Object.assign({},f,a);C(c,a,f);d(e,a,f);k&&k.update(a,c);for(d(h,a,f);this.__renderHooks.length;)a=this.__renderHooks.pop(),a.fn.call(a.context)};this.observe=
function(a,d,l){l=void 0===l?{}:l;var f=l.defer?h:e;(f[a]||(f[a]=[])).push(d);!1!==l.init&&(d.__calling=!0,d.call(b,c[a]),d.__calling=!1);return{cancel:function(){var c=f[a].indexOf(d);~c&&f[a].splice(c,1)}}};this.on=function(a,c){var f=v[a]||(v[a]=[]);f.push(c);return{cancel:function(){var a=f.indexOf(c);~a&&f.splice(a,1)}}};this.teardown=function(a){this.fire("teardown");k.teardown(!1!==a);k=null;c={}};E||Q();this.__renderHooks=[];for(var k=R(c,this,a.target);this.__renderHooks.length;)a=this.__renderHooks.pop(),
a.fn.call(a.context)}function H(a,d,b){if("entities"in d&&"object"===typeof a.entities||a.entities!==b.entities)a.groups=d.groups=y.computed.groups(a.entities)}function T(){var a=document.createElement("style");a.textContent="       \n  .cards[svelte-199336295], [svelte-199336295] .cards {\n    display: flex;\n    flex-wrap: wrap;\n    padding-top: 16px;\n    padding-left: 16px;\n  }\n";document.head.appendChild(a);I=!0}function U(a,d,b){function c(a){d.handleChange(a)}var e=document.createElement("div");
e.setAttribute("svelte-199336295","");e.className="cards";e.addEventListener("change",c,!1);var h=document.createComment("#each groups");e.appendChild(h);for(var g=a.groups,k=document.createDocumentFragment(),f=[],n=0;n<g.length;n+=1)f[n]=J(a,g,g[n],n,d,k);h.parentNode.insertBefore(k,h);b.appendChild(e);return{update:function(a,c){for(var b=c.groups,e=0;e<b.length;e+=1)f[e]?f[e].update(a,c,b,b[e],e):f[e]=J(c,b,b[e],e,d,k);for(e=b.length;e<f.length;e+=1)f[e].teardown(!0);h.parentNode.insertBefore(k,
h);f.length=b.length},teardown:function(a){e.removeEventListener("change",c,!1);a&&e.parentNode.removeChild(e);for(var b=0;b<f.length;b+=1)f[b].teardown(a);a&&h.parentNode.removeChild(h)}}}function J(a,b,g,c,e,h){var d=document.createComment("#if !group.attributes.hidden");h.appendChild(d);var k=g.attributes.hidden?null:K(a,b,g,c,e,h,d);return{update:function(a,c,b,g,m){g=b[m];g.attributes.hidden?k&&(k.teardown(!0),k=null):k?k.update(a,c,b,g,m):k=K(c,b,g,m,e,h,d)},teardown:function(a){k&&k.teardown(a);
a&&d.parentNode.removeChild(d)}}}function K(a,b,g,c,e,h,m){var d=new y.components.GroupCard({target:h,parent:e,data:{entities:a.entities,group:g}});return{update:function(a,c,b,e,g){b={};"entities"in a&&(b.entities=c.entities);"groups"in a&&(b.group=e);Object.keys(b).length&&d.set(b)},teardown:function(a){d.teardown(!0)}}}function L(a){function b(a,c,b){for(var f in a)if(f in c){var d=c[f],e=b[f];if(d!==e||"object"===typeof d){var h=a[f];if(h)for(var k=0;k<h.length;k+=1){var l=h[k];l.__calling||(l.__calling=
!0,l.call(g,d,e),l.__calling=!1)}}}}var g=this,c=Object.assign(y.data(),a.data);H(c,c,{});var e=Object.create(null),h=Object.create(null),m=Object.create(null);this.fire=function(a,c){if(a=a in m&&m[a].slice())for(var b=0;b<a.length;b+=1)a[b].call(this,c)};this.get=function(a){return c[a]};this.set=function(a){var d=c;c=Object.assign({},d,a);H(c,a,d);b(e,a,d);k&&k.update(a,c);for(b(h,a,d);this.__renderHooks.length;)a=this.__renderHooks.pop(),a.fn.call(a.context)};this.observe=function(a,b,d){d=void 0===
d?{}:d;var f=d.defer?h:e;(f[a]||(f[a]=[])).push(b);!1!==d.init&&(b.__calling=!0,b.call(g,c[a]),b.__calling=!1);return{cancel:function(){var c=f[a].indexOf(b);~c&&f[a].splice(c,1)}}};this.on=function(a,c){var b=m[a]||(m[a]=[]);b.push(c);return{cancel:function(){var a=b.indexOf(c);~a&&b.splice(a,1)}}};this.teardown=function(a){this.fire("teardown");k.teardown(!1!==a);k=null;c={}};I||T();this.__renderHooks=[];for(var k=U(c,this,a.target);this.__renderHooks.length;)a=this.__renderHooks.pop(),a.fn.call(a.context)}
var u=function(a,b){this.url=a;this.options=b||{};this.commandId=1;this.commands={};this.connectionTries=0;this.eventListeners={};this.closeRequested=!1};u.prototype.addEventListener=function(a,b){var d=this.eventListeners[a];d||(d=this.eventListeners[a]=[]);d.push(b)};u.prototype.fireEvent=function(a){var b=this;(this.eventListeners[a]||[]).forEach(function(a){return a(b)})};u.prototype.connect=function(){var a=this;return new Promise(function(b,g){var c=a.commands;Object.keys(c).forEach(function(a){a=
c[a];a.reject&&a.reject({type:"result",success:!1,error:{code:3,message:"Connection lost"}})});var d=!1;a.connectionTries+=1;a.socket=new WebSocket(a.url);a.socket.addEventListener("open",function(){a.connectionTries=0});a.socket.addEventListener("message",function(e){e=JSON.parse(e.data);switch(e.type){case "event":a.commands[e.id].eventCallback(e.event);break;case "result":e.success?a.commands[e.id].resolve(e):a.commands[e.id].reject(e.error);delete a.commands[e.id];break;case "auth_required":a.sendMessage({type:"auth",
api_password:a.options.authToken});break;case "auth_invalid":g(2);d=!0;break;case "auth_ok":b(a),a.fireEvent("ready"),a.commandId=1,a.commands={},Object.keys(c).forEach(function(b){var d=c[b];d.eventType&&a.subscribeEvents(d.eventCallback,d.eventType).then(function(a){d.unsubscribe=a})})}});a.socket.addEventListener("close",function(){d||a.closeRequested||(0===a.connectionTries?a.fireEvent("disconnected"):g(1),setTimeout(function(){return a.connect()},1E3*Math.min(a.connectionTries,5)))})})};u.prototype.close=
function(){this.closeRequested=!0;this.socket.close()};u.prototype.getStates=function(){return this.sendMessagePromise({type:"get_states"}).then(q)};u.prototype.getServices=function(){return this.sendMessagePromise({type:"get_services"}).then(q)};u.prototype.getPanels=function(){return this.sendMessagePromise({type:"get_panels"}).then(q)};u.prototype.getConfig=function(){return this.sendMessagePromise({type:"get_config"}).then(q)};u.prototype.callService=function(a,d,g){return this.sendMessagePromise(b(a,
d,g))};u.prototype.subscribeEvents=function(a,b){var d=this;return this.sendMessagePromise(m(b)).then(function(c){var e={eventCallback:a,eventType:b,unsubscribe:function(){return d.sendMessagePromise({type:"unsubscribe_events",subscription:c.id}).then(function(){delete d.commands[c.id]})}};return d.commands[c.id]=e,function(){return e.unsubscribe()}})};u.prototype.ping=function(){return this.sendMessagePromise({type:"ping"})};u.prototype.sendMessage=function(a){this.socket.send(JSON.stringify(a))};
u.prototype.sendMessagePromise=function(a){var b=this;return new Promise(function(d,c){b.commandId+=1;var e=b.commandId;a.id=e;b.commands[e]={resolve:d,reject:c};b.sendMessage(a)})};var z=function(){var a=["light","switch"];return{helpers:{canSwitch:function(b){return-1!==a.indexOf(t(b.entity_id))}}}}(),D=function(){return{computed:{entList:function(a,b){var d=x(a,b);return Object.keys(d).map(function(a){return d[a]})}},components:{EntityRow:P}}}(),E=!1,y=function(){return{methods:{handleChange:function(a){var b=
a.target;a=b.dataset.entity_id;b=b.checked?"turn_on":"turn_off";this.get("conn").callService("homeassistant",b,{entity_id:a})}},data:function(){return{entities:{}}},computed:{groups:function(a){return N(a).groups}},components:{GroupCard:S}}}(),I=!1;L.prototype=y.methods;var M=new L({target:document.querySelector(".page-content"),data:{entities:{}}});(new u("ws://localhost:8123/api/websocket",void 0)).connect().then(function(a){M.set({conn:a});r(a,function(a){console.log(a);M.set({entities:a})})})})();
